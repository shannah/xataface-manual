<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="Steve Hannah">
<title>Xataface Definitive Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Xataface Definitive Guide</h1>
<div class="details">
<span id="author" class="author">Steve Hannah</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_preface">Preface</a></li>
<li><a href="#_pre_history_of_xataface">1. Pre-history of Xataface</a>
<ul class="sectlevel2">
<li><a href="#_the_vision">1.1. The Vision</a></li>
</ul>
</li>
<li><a href="#_the_evolution_of_xataface">2. The Evolution of Xataface</a>
<ul class="sectlevel2">
<li><a href="#_influence_of_plone_on_xataface">2.1. Influence of Plone on Xataface</a></li>
<li><a href="#_influence_of_filemaker_on_xataface">2.2. Influence of FileMaker on Xataface</a></li>
<li><a href="#_outgrowing_the_mould">2.3. Outgrowing the Mould</a></li>
</ul>
</li>
<li><a href="#_fundmentals">Fundmentals</a></li>
<li><a href="#_introduction">3. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_requirements">3.1. Requirements</a></li>
<li><a href="#_license">3.2. License</a></li>
<li><a href="#_development_procedures">3.3. Development Procedures</a></li>
<li><a href="#_why_use_xataface">3.4. Why Use Xataface?</a></li>
</ul>
</li>
<li><a href="#_xataface_installation">4. Xataface Installation</a>
<ul class="sectlevel2">
<li><a href="#_prerequisites">4.1. Prerequisites</a></li>
<li><a href="#_installation_using_the_xataface_cli">4.2. Installation using the Xataface CLI</a></li>
</ul>
</li>
<li><a href="#_creating_your_first_xataface_app">5. Creating your first Xataface app</a>
<ul class="sectlevel2">
<li><a href="#_creating_a_new_table">5.1. Creating A New Table</a></li>
<li><a href="#_development_environment">5.2. Development Environment</a></li>
<li><a href="#_changing_field_labels">5.3. Changing Field Labels</a></li>
</ul>
</li>
<li><a href="#_a_more_complex_example_faculty_of_widgetry_app">6. A More Complex Example: Faculty of Widgetry App</a></li>
<li><a href="#_security">Security</a></li>
<li><a href="#_api_authentication">7. API Authentication</a>
<ul class="sectlevel2">
<li><a href="#_login">7.1. Login</a></li>
<li><a href="#_making_authenticated_requests">7.2. Making Authenticated Requests</a></li>
<li><a href="#_logging_out">7.3. Logging Out</a></li>
</ul>
</li>
<li><a href="#_actions">Actions</a></li>
<li><a href="#_using_material_icons">8. Using Material Icons</a></li>
<li><a href="#_form_customization">Form Customization</a></li>
<li><a href="#_multiple_tabs_in_forms">9. Multiple Tabs in Forms</a></li>
<li><a href="#_delegating_new_record_form_to_a_different_table">10. Delegating "New Record Form" to a Different Table</a>
<ul class="sectlevel2">
<li><a href="#_instructions_short_version">10.1. Instructions: Short Version</a></li>
<li><a href="#_instructions_by_example">10.2. Instructions By Example</a></li>
</ul>
</li>
<li><a href="#_using_ownerstamp_to_mark_record_ownership">11. Using <code>ownerstamp</code> to Mark Record Ownership</a></li>
<li><a href="#_redirecting_user_to_different_page_after_saving_record">12. Redirecting User to Different Page After Saving Record</a></li>
<li><a href="#_auto_updating_a_field_when_other_fields_are_changed">13. Auto-Updating a Field When Other Fields are Changed</a></li>
<li><a href="#_displaying_field_preview_using_ajax">14. Displaying Field Preview using AJAX</a></li>
<li><a href="#_disabling_client_side_validation">15. Disabling Client-side Validation</a></li>
<li><a href="#_setting_fixed_number_of_rows_in_the_grid_widget">16. Setting Fixed Number of Rows in the Grid Widget</a></li>
<li><a href="#_list_customization">List Customization</a></li>
<li><a href="#_adding_option_to_filter_result_list">17. Adding Option to Filter Result LIst</a>
<ul class="sectlevel2">
<li><a href="#_solution_9">17.1. Solution</a></li>
</ul>
</li>
<li><a href="#_hiding_filter_counts">18. Hiding Filter Counts</a></li>
<li><a href="#_sorting_filter_results">19. Sorting Filter Results</a></li>
<li><a href="#_searching">Searching</a></li>
<li><a href="#_case_sensitive_searches">20. Case-Sensitive Searches</a></li>
<li><a href="#_explicitly_specifying_case_sensitivity_of_a_search">21. Explicitly Specifying Case-sensitivity of a Search</a></li>
<li><a href="#_file_uploads">File Uploads</a></li>
<li><a href="#_specifying_content_disposition_of_file_download">22. Specifying Content Disposition of File Download</a></li>
<li><a href="#_http_request_handling">HTTP Request Handling</a></li>
<li><a href="#_specifying_a_default_action">23. Specifying a Default Action</a></li>
<li><a href="#_using_different_default_action_depending_on_table">24. Using Different Default Action Depending on Table</a></li>
<li><a href="#_specifying_default_query_parameters_for_default_actions">25. Specifying Default Query Parameters for Default Actions</a></li>
<li><a href="#_showing_the_edit_tab_by_default_for_record_details">26. Showing the "Edit" Tab By Default for Record Details</a></li>
<li><a href="#_setting_default_query_parameters_for_the_browse_action">27. Setting Default Query Parameters for the <code>browse</code> Action</a></li>
<li><a href="#_setting_a_related_records_tab_as_the_default_browse_action">28. Setting a Related Records Tab as the Default Browse Action</a></li>
<li><a href="#_tables_views_and_queries">Tables, Views, and Queries</a></li>
<li><a href="#_accessing_an_sql_query_like_a_table">29. Accessing an SQL query like a Table</a></li>
<li><a href="#_appendix_1_configuration_directives">Appendix 1: Configuration Directives</a></li>
<li><a href="#_preferences_directives">30. Preferences Directives</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_preface">Preface</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_pre_history_of_xataface">1. Pre-history of Xataface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Xataface was first released in 2005.  I had just been hired as a web services developer in the Faculty of Applied Sciences at Simon Fraser University, and I was inheriting resposibility for the maintenance and development of a relatively large content management system that had been built in-house, originally in PERL, and later ported to PHP.</p>
</div>
<div class="paragraph">
<p>This system, named "Group Content Management System", or GCMS for short, was used to manage information about all of the research groups in the faculty.  It included profiles for faculty members, grad students, labs, research groups, publications and projects.  It included administrative back-ends for administrators to update all of these profiles, and it served as a platform to publish web sites for faculty members and research groups.</p>
</div>
<div class="paragraph">
<p>The MySQL database, on which it was built, included dozens of tables, and a fairly complex set of relationships.  The PHP code for the application suffered from too many hands in the kitchen, with no central API to manage business rules.  Each form included custom PHP code and SQL commands to handle layout and validation.  It was not "a pleasure" to work on.</p>
</div>
<div class="paragraph">
<p>At my previous job, in the Faculty of Education,  I had built many similar systems, so I had reached the point where I was a little bored of the tedium involved in creating CRUD applications, as they were known.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
CRUD stands for "Create Read Update Delete", and it refers to a class of applications where the primary functions involve creating, reading, updating, and deleting records in a database.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the Faculty of Education we had used FileMaker extensively for our in-house databases.  It made the creation and maintenance of complex databases remarkably simple, and it provided an instant administrative user interface that was friendly for the clerical staff to maintain the database content themselves. I always felt limited by FileMaker though.</p>
</div>
<div class="paragraph">
<p>As long as you&#8217;re playing inside FileMaker&#8217;s box, it was great.  But if we wanted to integrate these databases into our web site, things got tricky.  At the time, you needed FileMaker server, and the web connector, which both carried expensive licenses.  We did have these products in the Faculty, and we did use the web connector to publish a few databases on the web, but it wasn&#8217;t performant and you couldn&#8217;t just use SQL to query the database.</p>
</div>
<div class="paragraph">
<p>We used <a href="https://github.com/yodarunamok/fxphp">FX.php</a> for interacting with the FileMaker database, which provided quite a nice abstraction layer, but we couldn&#8217;t benefit from FileMaker&#8217;s UI creation tools at all.  We were building our UIs from scratch, essentially, writing our own UI, validation, and queries.  In fact, I created a predecessor to Xataface that was built on FX.php, which generated the UI automatically using some config files, much the way that we do in Xataface.  This worked, pretty well, but, the reliance on Filemaker made our solutions less portable and slower than I would have liked. At this point, we weren&#8217;t benefiting from FileMaker&#8217;s UI development strengths at all since I was building the UI entirely in PHP, so I figured, why not try to do the same thing with a free, fast, ubiquitous database like MySQL.</p>
</div>
<div class="paragraph">
<p>And so, Xataface was born</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Originally Xataface was called "Dataface", but a Texas computer company named "Dataface" took exception to our name, and sent me a cease and desist letter.  So I changed the name to Xataface
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_the_vision">1.1. The Vision</h3>
<div class="paragraph">
<p>Most applications that I was building for the faculty had two parts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>The "public" front-end</strong>, which was usually integrated into a public website.  This might be the faculty profiles section of the website where faculty members' publications are displayed.  These pages would be generated using PHP, and pulling data directly from the database.</p>
</li>
<li>
<p><strong>The administrative back-end</strong>.  This is the interface that allows the clerical staff to update the faculty profiles in the database.  Some applications will have a single user managing all of the content in the database, while others will allow multiple users to update different content.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The public front-end would usually be created using HTML, CSS, and standard PHP, to fetch data from the database and display it. Quite often, the website would already have a template, so it would just be a matter of fetching data from the database and rendering it inside the site&#8217;s template.  For this portion of the application development, I was happy with the state of existing tools - i.e. vanilla PHP and MySQL to get the job done.  Each project was sufficiently different as to not benefit from a standardized framework.</p>
</div>
<div class="paragraph">
<p>For the administrative back-end, however, the work was tedious.  You needed to write forms to add new, edit, view, and delete records from each table.  The user interface needed to be friendly for non-technical users, since it would be used by regular folks - secretaries, faculty members, receptionists, etc..  You couldn&#8217;t just set up a database administration app like PHPMyAdmin.</p>
</div>
<div class="paragraph">
<p>It seemed to me that, for this type of application, the database schema already included all of the information needed to generate the user interface.  You could look at a table and see exactly what the form would need to look like for editing records on it.  VARCHAR fields should use a text field, TEXT fields should use a textarea, DATE fields should use a date or calendar widget etc&#8230;&#8203;  If we needed to provide additional configuration, such as explicitly choosing a different widget, or adding validation rules, the developer could create config files using a logical naming convention.</p>
</div>
<div class="paragraph">
<p>The first goal with Xataface was to see how much of the administrative back-end requirements could be achieved using only the database schema.  No configuration files, or custom PHP.</p>
</div>
<div class="paragraph">
<p>Of course, the first goal cannot be achieved 100%, so, the second goal of Xataface was, to the extent that the first goal cannot be achieved, how much of the administrative back-end requirements could be achieved using only the database schema, and some simple, human-friendly configuration settings.</p>
</div>
<div class="paragraph">
<p>Unfortunately, the second goal cannot usually be achieved 100%, so, the third goal of Xataface was, to the extent that the second goal cannot be achieved, make sure that the administrative back-end requirements can be fulfilled using as little custom PHP as possible.</p>
</div>
<div class="paragraph">
<p>The third goal can, in general, always be achieved.</p>
</div>
<div class="paragraph">
<p>After each application I develop using Xataface, I do a post-mortem to identify:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Features that were implemented PHP which can be achieved using configuration directives. I.e. moving features from the 3rd goal, into the 2nd goal. For example, initially, validation had to be handled using a PHP function, but eventually I added configuration directives for validation such as <code>validators:required</code> and <code>validators:lettersonly</code>.</p>
</li>
<li>
<p>Features that were implemented using configuration directives which can be achieved using heuristics using only the database schema.  I.e. moving features from the 2nd goal, into the 1st goal.  For example, initially fields marked <code>NON NULL</code> in the database can default to use the <code>validators:required</code> option, so that the user is forced to provide input.</p>
</li>
<li>
<p>Features that were implemented in PHP which could possibly be packaged as a reusable module.  I.e. reducing the complexity of PHP required to achieve the third goal.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The ultimate goal is to move <strong>everything</strong> into the first goal, but this will likely never fully occur as there will always be some features that can&#8217;t be automatically derived from the database schema - though with the advent of machine learning, I suppose anything is possible.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><strong>NO CODE GENERATION</strong></p>
</div>
<div class="paragraph">
<p>I decided early on, that I didn&#8217;t want to use code generation.  Most other CRUD frameworks I had experienced used code generation to generate a basic app which would then be customized by the developer.   Code-generation sounds great at first, but it quickly becomes unmaintainable.  The first app requirements are almost never the final requirements. If you generate PHP code for an app based on the database schema, and then you need to add a column or two, you&#8217;ll need to regenerate the code - which will cause you to lose any modifications you made in the mean time.</p>
</div>
<div class="paragraph">
<p>Xataface, instead uses conventions and configuration.  If you add a field to the database, you don&#8217;t need to regenerate anything.  Xataface will automatically include that field in the app from then on.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_evolution_of_xataface">2. The Evolution of Xataface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The first project that Xataface was applied to was the Group content management system (GCMS) of the Faculty of Applied Sciences.  This was the system that was used to manage the websites for faculty members, research groups, and publications.  The database was already built, and there was an existing administrative back-end that was, in my opinion, hard to work with.  I replaced this administrative back-end entirely using Xataface.  The application itself (not counting the code inside Xataface), contained almost no PHP code, and handful of configuration files.  The underlying database was left untouched.  The result was an application that was orders of magnitude easier to maintain, and, at the same time yielded a better user experience.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-280320-091647.625.png" alt="Image 280320 091647.625">
</div>
<div class="title">Figure 1. The original Dataface "List" view. This view showed the results of a query in a table.</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-280320-091749.102.png" alt="Image 280320 091749.102">
</div>
<div class="title">Figure 2. The "Details" view in the GCMS application.  This view allowed the user to edit a single record. Originally there was no "view" tab (read only details view), only a "main" tab that allowed editing a record.  Later on, I would add a "View" and "Edit" tab in the "Details" view.</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-280320-092637.616.png" alt="Image 280320 092637.616">
</div>
<div class="title">Figure 3. The "Find" tab in the GCMS application.  The find tab allowed searching on all fields in the table.</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-280320-092823.655.png" alt="Image 280320 092823.655">
</div>
<div class="title">Figure 4. The "Publications" tab in the GCMS application.  This is a "relationship" tab, as it shows only the publications related to a particular profile.  One of the key innovations of Xataface was its ability to define relationships, and have the application UI take advantage of these by providing <strong>add</strong>, <strong>remove</strong>, <strong>view</strong>, and <strong>search</strong> capabilities on those relationships.</div>
</div>
<div class="paragraph">
<p>After unrolling this "rewrite" of GCMS, I decided to release Xataface (then Dataface) to the world as an open source project.  I created a project on SourceForge, set up a website for it, wrote a "Getting Started" tutorial, and then returned to my day job, developing web applications or the faculty.</p>
</div>
<div class="sect2">
<h3 id="_influence_of_plone_on_xataface">2.1. Influence of Plone on Xataface</h3>
<div class="paragraph">
<p>At the time that I was developing the first version of Dataface, we were using the  <a href="https://www.plone.org">Plone</a> content management system for the faculty&#8217;s website.  If you&#8217;re familiar with Plone (circa 2005) you&#8217;ll recognize the tabs, lists, and navigation menus from the GCMS screenshots.  That&#8217;s because I used the plone stylesheet as a basis for Xataface&#8217;s styles.  I really liked the way Plone looked, and the stylesheet had many of the UI elements that I needed for Xataface.  I needed tabs - Plone had nice looking tabs.  I needed tabular lists.  Plone has nice looking sortable lists.  I needed navigation menus.  Etc&#8230;&#8203;  Some of these elements have persisted to present day.  Xataface 2.0 included a new default theme, "g2", that introduced a totally new stylesheet, but developers could still "opt out" of the "g2" theme and use the original plone theme.
Xataface 3.0 finally eliminates the original theme (nearly) entirely, but if you dig you can likely still find some elements of that original Plone theme.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-280320-101804.269.png" alt="Image 280320 101804.269">
</div>
<div class="title">Figure 5. Plone content management system circa 2005.  The initial release of Xataface used the Plone stylesheet, and many aspects of the design can still be found in the Xataface of today, if you look closely.</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>From Wikipedia:</p>
</div>
<div class="paragraph">
<p>Plone is a free and open source content management system built on top of the Zope application server. Plone is positioned as an "Enterprise CMS" and is commonly used for intranets and as part of the web presence of large organizations. High-profile public sector users include the U.S. Federal Bureau of Investigation, Brazilian Government, United Nations, City of Bern (Switzerland), New South Wales Government (Australia), and European Environment Agency.[2] Plone&#8217;s proponents cite its security track record[3] and its accessibility[4] as reasons to choose Plone.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Aside from the stylesheet, Plone also inspired some other aspects of Xataface&#8217;s design.  In particular, Xataface&#8217;s use of actions (e.g. the actions.ini file) to inject menus, buttons, and functionality into the UI are directly pulled from Plone.</p>
</div>
</div>
<div class="sect2">
<h3 id="_influence_of_filemaker_on_xataface">2.2. Influence of FileMaker on Xataface</h3>
<div class="paragraph">
<p>I&#8217;ve already discussed the fact that FileMaker was a key inspiration for Xataface.  I liked the way that FileMaker allowed mere mortals to both create and manage relatively complex databases. It was impressive that an office assistant,  with no programming skills whatsoever, could build a fully-functional database application with a nice user interface in a few hours.  To do the same thing with PHP and MySQL would take a software developer weeks, and it likely still would have been missing features that the FileMaker app provides out of the box.</p>
</div>
<div class="paragraph">
<p>The Xataface "Details", "Find", and "List" tabs were an answer to FileMaker&#8217;s "Details", "List" and "Find" modes.</p>
</div>
<div class="paragraph">
<p>The one mode that Xataface didn&#8217;t provide an answer for is the "Layout" mode, which is the mode of FileMaker that allows users to design their own forms using a drag and drop palette of widgets and a canvas.  Xataface, instead, just used HTML for its views.</p>
</div>
<div class="paragraph">
<p>One day, I&#8217;d like to add such a tool to Xataface, but, frankly, it&#8217;s difficult to do well, and time is almost always better spent extending Xataface&#8217;s other features.</p>
</div>
</div>
<div class="sect2">
<h3 id="_outgrowing_the_mould">2.3. Outgrowing the Mould</h3>
<div class="paragraph">
<p>At the beginning, Xataface was just intended to be an open source alternative to FileMaker.  It didn&#8217;t take long, however to start growing in its own direction.  Today it has become a full-featured platform on which arbitrary data-driven web applications can be built.</p>
</div>
<div class="paragraph">
<p>Early on, I added support for modules, custom actions, and pluggable authentication.  These foundational elements enabled grown into application types not originally envisioned.</p>
</div>
<div class="paragraph">
<p>Xataface was being downloaded thousands of times per week from SourceForge, and developers were contacting about a diverse range of applications that they were building.  Over the next few years, I used Xataface as the foundation for many side projects including:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>An auction application, <a href="https://github.com/shannah/webauction">WebAuction</a>, which has hosted hundreds of online auctions for non-profit organizations ranging from the United Way, to the SFU Plant Sale.</p>
<div class="imageblock">
<div class="content">
<img src="images/Image-290320-090051.779.png" alt="Image 290320 090051.779">
</div>
<div class="title">Figure 6. WebAuction used to host the annual SFU platsale was written with Xataface.</div>
</div>
</li>
<li>
<p>A church library application, LibrarianDB,  for managing the books in a church library.</p>
<div class="imageblock">
<div class="content">
<img src="images/Image-290320-090701.286.png" alt="Image 290320 090701.286">
</div>
<div class="title">Figure 7. LibrarianDB, developed with Xataface, was developed to help manage books in a church library</div>
</div>
</li>
<li>
<p>A general content management system for a website ("Little Content Management System" or LCMS).</p>
</li>
<li>
<p>A registration system for people to apply for sessional instructor, and TA positions in the faculty.</p>
</li>
<li>
<p>Survey Builder, an application for creating and hosting surveys online.</p>
<div class="imageblock">
<div class="content">
<img src="images/Image-290320-091221.806.png" alt="Image 290320 091221.806">
</div>
<div class="title">Figure 8. A survey built and hosted by SurveyBuilder.</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-290320-091301.571.png" alt="Image 290320 091301.571">
</div>
<div class="title">Figure 9. Administrative back-end for SurveyBuilder.  This uses the g2 theme.</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-290320-091403.237.png" alt="Image 290320 091403.237">
</div>
<div class="title">Figure 10. Editing the survey content for SurveyBuilder in the Xataface back-end.  This used the CKeditor module for WYSIWYG HTML editing.</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Over the years, Xataface has added countless features that improve the developer and user experience alike. I have enjoyed building it, and I sincerely hope that you enjoy using it to build your own creations.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fundmentals">Fundmentals</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section covers the fundamentals of Xataface</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">3. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Xataface is a simple framework for building data-driven web applications in PHP and MySQL. This section introduces some of the concepts and applications of Dataface.
To fully understand what Xataface is, we must first define a few key terms:</p>
</div>
<div class="paragraph">
<p><strong>Framework</strong> - A set of software routines that provide a foundation structure for an application. Frameworks take the tedium out of writing an application from scratch. (From Answers.com)</p>
</div>
<div class="paragraph">
<p><strong>Data-driven design</strong> - Designing an application around the data that it will store.</p>
</div>
<div class="paragraph">
<p>Xataface is a Framework in the sense that it is a set of classes and libraries that take the tedium out of writing web applications. It provides a simple web interface to a MySQL database enabling users to update, delete, and find data in the underlying database. The interface is targeted at secretaries and end-users as opposed to database administrators.</p>
</div>
<div class="paragraph">
<p>Xataface enables data-driven design because it allows developers to develop web sites by first designing the database that will be used to store the data on the website, and then design the pages used to display the data. The developer can focus on the data because he or she does not have to worry about having to build forms to update the data. If the requirements of the application change, the developer can simply add a field to the database table and all associated web forms will be updated automatically (because they are all dynamically generated using the database schema).</p>
</div>
<div class="sect2">
<h3 id="_requirements">3.1. Requirements</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>PHP &gt;= 4.3 (for Xataface 1.1.x and lower);  PHP &gt;= 5 for Xataface 1.2 and higher</p>
</li>
<li>
<p>MySQL &gt;= 3.2.3  (Some features require 4.1 or higher).</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_license">3.2. License</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>GPLv2</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_development_procedures">3.3. Development Procedures</h3>
<div class="paragraph">
<p>Identify the data that will need to be stored for a web site.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-290320-093727.459.png" alt="Image 290320 093727.459">
</div>
<div class="title">Figure 11. ERD diagram describing a simple database with two tables, "Program" and "Courses", with a relationship between them.</div>
</div>
<div class="paragraph">
<p>Design the database using your favorite database administration program (e.g., PHPMyAdmin)</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-290320-093844.702.png" alt="Image 290320 093844.702">
</div>
<div class="title">Figure 12. PHPMyAdmin is a popular tool for creating databases on MySQL/MariaDB.  You can use any tool you like for creating your database, or no tool at all (i.e. raw SQL).</div>
</div>
<div class="paragraph">
<p>Tell Xataface some DB connection info, and voila! You have an application:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-290320-094309.877.png" alt="Image 290320 094309.877">
</div>
<div class="title">Figure 13. Bare-bones Xataface application out of the box with no customizations.</div>
</div>
</div>
<div class="sect2">
<h3 id="_why_use_xataface">3.4. Why Use Xataface?</h3>
<div class="paragraph">
<p>Some simple examples similar to those that are frequently encountered by web developers, and how dataface can be used to acheive a solution.</p>
</div>
<div class="paragraph">
<p>As a web services developer would frequently getting requests to build websites that were manageable by the site owner.  Most of these requests also specify certain types of content that must be stored on the website, and much of this content needs to be n-ary (i.e., there will be multiple instances of each type of content).  Let me give you an example.</p>
</div>
<div class="sect3">
<h4 id="_example_1_website_for_faculty_of_widgetry">3.4.1. Example 1: Website for Faculty of Widgetry</h4>
<div class="paragraph">
<p>The Faculty of Widgetry needs a website to publish information about its undergraduate programs.  It is important for them to be able to publish admission requirements, and program overviews for each program.  It is also important to have course outlines and timetables for each course. The Faculty of Widgetry has 12 undergraduate programs and over 100 courses offered.</p>
</div>
<div class="sect4">
<h5 id="_solution_1_static_html">Solution 1: Static HTML</h5>
<div class="paragraph">
<p>To build this web site using only static HTML pages using Dreamweaver or some other HTML editor would require at least 112 pages to be created (one for each course and program).  However, once we recognize that there are only 2 types of pages required (one for courses and one for programs), we can reduce the task down to creating 2 templates and filling in the main content for each program and course individually.  Most HTML editors have some templating ability so you can make changes to the template and have the changes propogated to all pages that use that template with the click of a button.</p>
</div>
<div class="paragraph">
<p>This works great, but courses are added frequently, and outlines are changed.  Do you really want to receive requests to update all of these pages every time there are changes to make?  (If your answer is 'yes', then you probably won&#8217;t be interested in reading the rest of this tutorial).  Whether the Dean of the faculty knows it or not, it is very important for the program assistants to be able to update these web pages on their own.  To acheive these goals you can:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install Dreamweaver on the Program Assistants' computers, teach them how to use it, and allow them to perform updates.</p>
</li>
<li>
<p>Install Contribute, which is a scaled down version of Dreamweaver to make it easier for the Program Assistants to edit the content.</p>
</li>
<li>
<p>Use another solution that is equivalent to one of the above 2 solutions.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Installing Dreamweaver for each Program Assistant is a little overkill, and since it has the ability to do much more than just update content.  In addition,  Dreamweaver is really a developer&#8217;s tool - not a secretary&#8217;s tool, so it can be difficult to learn at first.  The best reason NOT to install Dreamweaver on the Program Assistant&#8217;s computer, however, is that it enables him/her to muck things up by accident (believe me, I has happened to me more times than I care to count).</p>
</div>
<div class="paragraph">
<p>Admittedly, Contribute is a viable option as it controls access to only certain portions of web pages to be edited, and it is targetted at secretaries (not developers) so it is easier to use.  In fact, given the requirements for this web site (as stated above), this is a perfectly good solution.  However you better hope that none of the following requirements are added:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Each program web page should contain an up-to-date list of all of the courses required for the program, along with a link to the course outline for that course.</p>
</li>
<li>
<p>Course outlines should be available in PDF format as well as HTML format.</p>
</li>
<li>
<p>An index page showing all of the courses available should be added.  This page must allow courses to be organized by program, course subject, or course number.</p>
</li>
<li>
<p>Any other requirement that would have information formatted in more than one way.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If any of these requirements are likely to be added (EVER) then you would be well-advised to look into solutions that  use a database back-end.</p>
</div>
</div>
<div class="sect4">
<h5 id="_solution_2_use_a_content_management_system_cms">Solution 2: Use a Content Management System (CMS)</h5>
<div class="paragraph">
<p>There are hundreds of content management systems available that will allow you to store and update content through the web (TTW).  Some of them even have an assortment of add-ons that will allow you to store more specific types of information.  Some good CMS&#8217;s include Plone, Drupal, and Xoops.  Suppose we want to develop the Faculty of Widgetry website using one of these CMS&#8217;s.  Any good CMS will allow you to create and edit HTML documents easily (without having to write any custom products).  However, it is often the case that our documents require the content to be structured.  For example, each program has some common data associated with it: Program Name, Admission Deadline, Program Description, Outline, Courses, etc&#8230;&#8203;  If we want to properly separate data from presentation, we would need to build a special content-type to store our programs.  Most CMS&#8217;s allow you to develop custom content-types using the underlying programming language and an API (Application Programming Interface).  Some API&#8217;s are easier to use than others and some are documented better than others.  The common element is that each has its own proprietary interface for writing these add-ons.</p>
</div>
<div class="paragraph">
<p>If you are using a CMS and you are proficient in the creation of add-on content-types, then you will be able to build the Faculty of Widgetry website without great difficulty.  However there are a number of reasons why you may choose NOT to use a CMS:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Steep learning curve: Depending on the CMS it can be very time consuming and difficult to learn how to use and modify the CMS to suit you purposes.</p>
</li>
<li>
<p>It is over-kill: Most CMS&#8217;s are filled with features and modules that you will never need.  In fact it can even be a pain to turn them off if you don&#8217;t want them.</p>
</li>
<li>
<p>You can get tied into the CMS:  When you are using a CMS, you will start developing for the CMS.  With all of your content in the CMS it may be difficult to migrate to a different solution later on.  (The truth of this statement will vary for different CMS&#8217;s).  Choose your CMS carefully.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_solution_3_use_an_existing_application">3.4.2. Solution 3: Use an existing Application</h4>
<div class="paragraph">
<p>OK, OK, let&#8217;s not get too carried away with trying to develop the website until we have checked the market to see if someone else has already done it better.  Maybe there is already a PHP application that makes websites for Faculties easy.  I mean, I can&#8217;t be the first person that needed to build a website for a Faculty.  In fact if you do a search or go to Hotscripts.com, you will probably find a handful of applications or scripts that almost do what you need.  If you&#8217;re lucky, maybe you can find an application that does exactly what you need (but frankly, I&#8217;ve never been that lucky).  If you find one, maybe it&#8217;s worth taking it for a test drive.  But beware. Using a system that almost does what you need but is difficult to modify to your needs can be worse than building it by scratch.  Make sure that you are able to modify the application to suit your needs exactly.</p>
</div>
<div class="sect4">
<h5 id="_solution_4_use_php_and_mysql">Solution 4: Use PHP and MySQL</h5>
<div class="paragraph">
<p>If all we want to do is separate the data from the presentation and allow the Program Assistants to update data on the website, why not just design a MySQL database with the appropriate tables and fields to store the required data.  In our case we will need 2 tables:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">Programs
    Fields:
        ProgramID : int
        ProgramName : varchar
        ProgramDescription: text
        AdmissionDeadline: date
        Outline_HTML : text
        Outline_PDF : blob
Courses
    Fields:
        CourseID : int
        CourseSubject : varchar
        CourseTitle : varchar
        CourseNumber : int
        ProgramID : int
        CourseDescription : text
        Outline_HTML : text
        Outline_PDF : blob</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now it&#8217;s easy to create a few web pages that extract data from the database and displays it as HTML.  In fact if there is an existing page template that you can use for the header and footer, you can develop the entire Faculty website in under an hour (you just have to create 3 pages).</p>
</div>
<div class="paragraph">
<p><strong>Question</strong>: How will the Program Assistants update the information in the database?</p>
</div>
<div class="paragraph">
<p><strong>Answer</strong>: OK, let&#8217;s assume that you&#8217;re not going to teach them SQL and that a DB Admin tool will also be too difficult to learn.  Then you have to create HTML forms to update records in the database.</p>
</div>
<div class="paragraph">
<p>Ouch!  What was easy just became hard.  Making HTML forms is a real pain, because you have to validate the input, deal with file uploads, and also make sure that everything is stored to the database OK without losing any information.  Such a basic task, but it can be very difficult.  This is when it is time to use Xataface.</p>
</div>
</div>
<div class="sect4">
<h5 id="_solution_5_use_xataface">Solution 5: Use Xataface</h5>
<div class="paragraph">
<p>OK, this isn&#8217;t really its own solution.  It is more like "Solution 4 Part II", because Xataface is intended to complement your custom application you built with solution 4, by providing an easy-to-use, configurable user interface that is targeted at secretaries and normal users (as opposed to database administrators).  A Xataface application takes only seconds to set up and it will provide you with a full user interface for your users to edit information in the database.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_xataface_installation">4. Xataface Installation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Over the years I have developed several different installation mechanisms for Xataface.  At the end of the day, installation only requires that you copy the <strong>xataface</strong> directory onto your web server.  To update it, you simply replace that directory with the new version.</p>
</div>
<div class="paragraph">
<p>Creating an application with Xataface, however, involves more than just <strong>installing</strong> Xataface.  You need to, at minimum create a config file with your database connection settings, and a 2-line PHP script (usually named "index.php") to serve as an entry point for your application.</p>
</div>
<div class="paragraph">
<p>And this all assumes that you already have a web server set up with PHP and MySQL, and that you&#8217;ve created a database for your application to use.</p>
</div>
<div class="paragraph">
<p>With version 3.0, Xataface now includes a command line (CLI) utilty to automate common tasks like creating new apps, generating delegate classes, enabling authentication, etc&#8230;&#8203;  This tutorial describes the installation and usage of this CLI script for creating and maintaining Xataface applications.  If you would prefer to do things manually, you can skip to the "Manual Installation" section.</p>
</div>
<div class="sect2">
<h3 id="_prerequisites">4.1. Prerequisites</h3>
<div class="paragraph">
<p>Before you install Xataface, you should have a PHP and MySQL installed. I recommend XAMPP</p>
</div>
</div>
<div class="sect2">
<h3 id="_installation_using_the_xataface_cli">4.2. Installation using the Xataface CLI</h3>
<div class="listingblock">
<div class="title">Paste the following into macOS Terminal or Linux shell prompt</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/shannah/install-xataface/master/install.sh)"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This command will install Xataface at <code>~/xataface</code> (i.e. inside your home directory).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The output of this script will look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/shannah/install-xataface/master/install.sh)"
Cloning into 'xataface'...
remote: Enumerating objects: 180, done.
remote: Counting objects: 100% (180/180), done.
remote: Compressing objects: 100% (125/125), done.
remote: Total 12947 (delta 105), reused 110 (delta 50), pack-reused 12767
Receiving objects: 100% (12947/12947), 19.50 MiB | 11.95 MiB/s, done.
Resolving deltas: 100% (7814/7814), done.
Adding /Users/shannah/xataface/bin to your path in /Users/shannah/.bash_profile</code></pre>
</div>
</div>
<div class="paragraph">
<p>This installs the <code>xataface</code> CLI script at <code>~/xataface/bin/xataface</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_your_first_xataface_app">5. Creating your first Xataface app</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that you have xataface installed, we can proceed to create our first app.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>Please ensure that you have both <code>mysql</code> and <code>apachectl</code> in your PATH.  If you are using XAMPP for your server, this can be accomplished with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">export PATH=/Applications/XAMPP/xamppfiles/bin:$PATH</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Open a command prompt and enter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">xataface create hello-world</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output will be as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ xataface create hello-world
Create project at hello-world
Setting up scaffold at hello-world ...Done
Checking for PHPMyAdmin installation...Found.
Linking /Users/shannah/.xataface/phpmyadmin to hello-world/lib/phpmyadmin ...Done.
Copying xataface to hello-world/www/xataface ...Done.
Removing hello-world/www/xataface/site_skeleton ...Done.
Initializing database ...
Starting mysql server...Started Successfully
Bootstrapping database...Done
Stopping mysql server...Stopped
Done</code></pre>
</div>
</div>
<div class="paragraph">
<p>At this point, you should have a new directory named "hello-world", which contains our application&#8217;s directory structure.</p>
</div>
<div class="paragraph">
<p>We can launch our app by "cd"ing into our new "hello-world" directory and running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">xataface start</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will fire up MySQL and Apache with document root at "www" and the database stored in "data"</p>
</div>
<div class="paragraph">
<p>The console output will be something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">Starting apache on port 9090
No services added.
Starting MariaDB
PID FILE /Users/shannah/Vagrant/hello-world/bin/../data/Steves-MacBook-Pro-2.local.pid

Waiting for ready
kill -0 says wait some more...
.Waiting for ready
We are ready
 SUCCESS!
About to touch lock file /Users/shannah/Vagrant/hello-world/bin/../tmp/mysql
Exiting with return value 0
Did start mysql server
No services added.
Did start apache server</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, point your web browser to "http://localhost:9090"</p>
</div>
<div class="paragraph">
<p>You should see something like:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-210320-073817.755.png" alt="Image 210320 073817.755">
</div>
<div class="title">Figure 14. A vanilla Xataface application created with the "xataface create" command.</div>
</div>
<div class="paragraph">
<p>This database has only a single table named "test", which contains a single column named "test_field".  You can add new record by clicking "New Record".</p>
</div>
<div class="paragraph">
<p>You&#8217;ll see a "new record" form:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-210320-074221.388.png" alt="Image 210320 074221.388">
</div>
<div class="title">Figure 15. Xataface new record form for the default "test" table.</div>
</div>
<div class="paragraph">
<p>Enter "Hello World" into the test field and press "Save".</p>
</div>
<div class="paragraph">
<p>You should see a message saying "Record successfully saved".</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-210320-074350.524.png" alt="Image 210320 074350.524">
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_new_table">5.1. Creating A New Table</h3>
<div class="paragraph">
<p>Xataface provides an installation of PHPMyAdmin to assist you in building a database for your application.  You can access PHPMyAdmin at the URL:  <code><a href="http://localhost:9090/phpmyadmin" class="bare">http://localhost:9090/phpmyadmin</a></code></p>
</div>
<div class="paragraph">
<p>Open a new browser tab with this URL, and you should see something like:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-210320-074835.666.png" alt="Image 210320 074835.666">
</div>
</div>
<div class="paragraph">
<p>The database for this app is named "hello-world", and it is listed in the left-hand menu for PHPMyAdmin.  Click on that node to expand, it, then select "New":</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-210320-075036.734.png" alt="Image 210320 075036.734">
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s add a table called notes, by filling in the new table form as follows:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-210320-075421.538.png" alt="Image 210320 075421.538">
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Be sure to check the "A/I" box for the "note_id" field so that it will be an auto increment field.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Press "Save" when done.</p>
</div>
<div class="paragraph">
<p>Now we want to tell Xataface to use this table in our application.  Open the <code>www/conf.ini.php</code> file in our app.  The contents will look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">;&lt;?php exit;
__include__=conf.db.ini.php

[_tables]
    test=test</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>[_tables]</code> section is used by Xataface to generate the top menu in your application.  Let&#8217;s tell it to use our new "notes" table by adding the following:</p>
</div>
<div class="listingblock">
<div class="title">The conf.ini.php file after adding the "notes" table to the list of tables for our app to use.</div>
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">;&lt;?php exit;
__include__=conf.db.ini.php

[_tables]
    test=test
	notes=Notes <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The left "notes" indicates the table name.  The right "Notes" indicates the label that should be used in our tables menu.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Save this file and reload the application in the web browser.</p>
</div>
<div class="paragraph">
<p>You should now see a "Notes" tab on the top.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-210320-075955.851.png" alt="Image 210320 075955.851">
</div>
</div>
<div class="paragraph">
<p>Click on this tab, then press "New Record" to see our form for adding records.  You should see something like:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-210320-080256.754.png" alt="Image 210320 080256.754">
</div>
</div>
<div class="paragraph">
<p>This form includes inputs for all of the columns in our table, except the "note_id" column.  This is because "note_id" is an auto-increment field and doesn&#8217;t require user input.</p>
</div>
<div class="paragraph">
<p>Each field uses a different type of widget according to the type of the underlying database column.  E.g. the "Title" field is a text field because it is a VARCHAR column.  The "note_content" field is a text area because it is a TEXT column, etc&#8230;&#8203;  You can override the widget that is used to edit any field very easily by editing the "fields.ini" file for the "notes" table, which we&#8217;ll do in the new section.</p>
</div>
<div class="paragraph">
<p>For now we will use this application as is while we explore the application interface.</p>
</div>
<div class="paragraph">
<p>Enter some dummy data into this form and press "Save".  Then press "New Record", and enter another new record.  Create 3 or 4 notes with different content so that we have something to play with.</p>
</div>
<div class="paragraph">
<p>Once you&#8217;ve entered a few notes, click on the "Notes" tab to return to the "List" view of the "notes" table.  My app looks like the following screenshot, as I&#8217;ve entered 3 notes:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-210320-081024.587.png" alt="Image 210320 081024.587">
</div>
</div>
<div class="sect3">
<h4 id="_filtering_the_list">5.1.1. Filtering the List</h4>
<div class="paragraph">
<p>Xataface provides a few different ways to filter the list view.  We can:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click on a column header to search by column content.</p>
</li>
<li>
<p>Enter a keyword search into the top right search box, which will look for matches in <strong>any</strong> column of the table.</p>
</li>
<li>
<p>We can do an advanced "Find" by clicking on the "Find" tab.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Later we&#8217;ll also learn how to add "filter" drop-down lists.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-210320-081432.732.png" alt="Image 210320 081432.732">
</div>
<div class="title">Figure 16. Clicking on the column heading in list view will reveal search boxes to search on one or more columns.</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-210320-081559.817.png" alt="Image 210320 081559.817">
</div>
<div class="title">Figure 17. Entering keywords into the top-right search box will allow you to look for matches in any column of the table.</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-210320-081653.719.png" alt="Image 210320 081653.719">
</div>
<div class="title">Figure 18. The "Find" tab includes an advanced search form which includes a field for each column in the table.</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_development_environment">5.2. Development Environment</h3>
<div class="paragraph">
<p>At this point we have a fully-functional database application, and you didn&#8217;t have to write a single line of code.  Let&#8217;s pull the curtain back a little and see what&#8217;s going on in our application under the hood.</p>
</div>
<div class="paragraph">
<p>The "hello-world" directory that was created by xataface when we ran "xataface create hello-world" contains the following folders:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-220320-071850.431.png" alt="Image 220320 071850.431">
</div>
<div class="title">Figure 19. The root application directory generated by <code>xataface create hello-world</code></div>
</div>
<div class="paragraph">
<p>This root directory comprises a mini development environment for our application.  The application itself is entirely contained inside the "www" directory, and when it comes time to deploy the app to production, we will likely <strong>only</strong> be uploading this directory to the web server.</p>
</div>
<div class="paragraph">
<p>The subdirectories in this folder include:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>app</strong> - This is a symlink to the www directory, however, in cases where the Xataface app is actually contained in a subfolder of "www", this symlink will point to that subdirectory.  The Xataface maintenance scripts always use "app" as the app&#8217;s document root (i.e. the directory containing conf.ini).</p>
</li>
<li>
<p><strong>bin</strong> - This directory contains a set of maintenance scripts that can be used to automate certain maintenance tasks.  This is for the development environment only, and does not need to be copied to the production web server.</p>
</li>
<li>
<p><strong>data</strong> - This directory stores the development mysql database files.  This is for the development environment only.  On the production server, there will likely be a single central MySQL/MariaDB server where your database will reside.</p>
</li>
<li>
<p><strong>etc</strong> - This directory stores apache and mysql config files used for the development environment only.</p>
</li>
<li>
<p><strong>install.sql</strong> - This stores the SQL to recreate the database.</p>
</li>
<li>
<p><strong>lib</strong> - This directory stores some additional libraries that may be useful for the development environment, such as PhpMyAdmin.  This is for the development environment only, and should not be copied to the production web server.</p>
</li>
<li>
<p><strong>log</strong> - Apache and MySQL log files for the development environment.</p>
</li>
<li>
<p><strong>tmp</strong> - The temp directory for the development environment.</p>
</li>
<li>
<p><strong>www</strong> - This is the actual directory containing our application.  When we deploy to a production, this is the only folder that needs to be copied to the web server.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_application_structure">5.2.1. Application Structure</h4>
<div class="paragraph">
<p>As mentioned above, the "www" directory contains the meat of our application.  Let&#8217;s take a look at its contents now.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-220320-073743.112.png" alt="Image 220320 073743.112">
</div>
<div class="title">Figure 20. The www directory contains the document root of our application.</div>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look at the files that were generated and placed in this directory.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>conf.db.ini.php</strong> - Config file containing <strong>only</strong> the database connection information.</p>
</li>
<li>
<p><strong>conf.ini.php</strong> - Config file containing application-wide configuration.</p>
</li>
<li>
<p><strong>index.php</strong> - The entry point to your application.</p>
</li>
<li>
<p><strong>templates_c</strong> - This directory containes compiled Smarty templates.  This needs to be writable by the web server.</p>
</li>
<li>
<p><strong>Web.config</strong> - A security file for IIS to prevent it from serving ".ini" files.  This is really only necessary when using Xataface on IIS.  The .htaccess file provides the equivalent functionality for Apache.</p>
</li>
<li>
<p><strong>xataface</strong> - The actual xataface library used by the app.  Updating your application to a newer version of Xataface later will be as simple as replacing this directory with the latest version.</p>
</li>
<li>
<p><strong>.htaccess</strong> - This file is omitted by the screenshot, but the app also contains an .htaccess file which prevents Apache from serving ".ini" files.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In this tutorial you&#8217;ll notice that all .ini files have a .php extension.  E.g. we have "conf.ini.php" rather than "conf.ini".  Xataface supports both notations, but you should choose one and stick to it.  The benefit of using the ".php" extension, is that you can block any PHP-enabled web server from serving the file by adding <code>;&lt;?php exit;</code> on the first line of the file.  We also include an .htaccess file and Web.config file for blocking .ini files, but these only apply to IIS and Apache web servers respectively.  If you&#8217;re using a different web server, such as NginX or the PHP development server, then these .htaccess will be ignored and your .ini files may get served to the public - which you don&#8217;t want.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_changing_field_labels">5.3. Changing Field Labels</h3>
<div class="paragraph">
<p>Out of the box, Xataface will assign appropriate labels to its form fields based on the underlying columns.  However, you can override these labels very easily.</p>
</div>
<div class="paragraph">
<p>To customize labels for the "notes" table we need to create a file at <code>www/tables/notes/fields.ini.php</code></p>
</div>
<div class="paragraph">
<p>The <code>xataface</code> CLI script will generate this file for us via the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ xataface create-fieldsini notes
Created tables/notes/fields.ini.php</code></pre>
</div>
</div>
<div class="paragraph">
<p>As the output indicates, this created a file at tables/notes/fields.ini.php.  Let&#8217;s open it up to take a look at the contents.</p>
</div>
<div class="listingblock">
<div class="title">The fields.ini file generated for the "notes" table.</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">;&lt;?php exit; <b class="conum">(1)</b>
[note_id]

[title]

[note_content]

[date_posted]

[status]</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>First line for security.  It will block any php-enabled web server from serving this file.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>It has generated empty sections for each field in the "notes" table.  All configuration options for a field should go in its section.</p>
</div>
<div class="paragraph">
<p>Now let&#8217;s customize some field labels and descriptions.  We can set a field&#8217;s label using the "widget:label" property, and we can add some "help" text using the "widget:description" property.  Let&#8217;s customize the labels and descriptions for this form by adding these properties.</p>
</div>
<div class="paragraph">
<p>After making a few changes, my fields.ini file now looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">;&lt;?php exit;
[note_id]

[title]
  widget:label=Note title
  widget:description=Enter a descriptive title for this note

[note_content]
  widget:label=Contents
  widget:description=Enter the full content of the note here

[date_posted]

[status]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, open your browser again and try to add a new note.  You&#8217;ll notice that the form has changed:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-220320-075604.685.png" alt="Image 220320 075604.685">
</div>
<div class="title">Figure 21. New record form includes custom labels and descriptions based on the <code>widget:label</code> and <code>widget:description</code> properties I added to the fields.ini file.</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_a_more_complex_example_faculty_of_widgetry_app">6. A More Complex Example: Faculty of Widgetry App</h2>
<div class="sectionbody">
<div class="paragraph">
<p>sf</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_security">Security</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following chapters cover all things security-related in Xataface.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_api_authentication">7. API Authentication</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="images/Image-140420-113308.724.png" alt="Image 140420 113308.724">
</div>
<div class="title">Figure 22. Login sequence using example curl HTTP request.</div>
</div>
<div class="paragraph">
<p>Xataface provides a REST API for authentication so that you can access your application using a REST client.  When using this API, you&#8217;ll perform a request to the "login" action to obtain an authentication token.  You can then make authenticated requests to your app by adding this token in the Authorization header as a bearer token.</p>
</div>
<div class="sect2">
<h3 id="_login">7.1. Login</h3>
<div class="paragraph">
<p>To log in using the API, simply perform a POST request to <code>?-action=login&amp;--no-prompt=1</code></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>UserName</code> - The username to log in with.</p>
</li>
<li>
<p><code>Password</code> - The password to log in with.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If login succeeds, you&#8217;ll receive a JSON response with a token.  E.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "code":200,
  "token":"576646...2dDRuOGUycGI=",
  "message":"Logged in"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An unsuccessful login will look something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{"code":500,"message":"No UserName provided."}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_making_authenticated_requests">7.2. Making Authenticated Requests</h3>
<div class="paragraph">
<p>Once you have obtained a token, you should include this token in the <code>Authorization</code> header of HTTP requests.  E.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">curl -H 'Authorization: Bearer {TOKEN}' https://example.com?index.php</code></pre>
</div>
</div>
<div class="paragraph">
<p>But replace <code>{TOKEN}</code> with your token received during login.</p>
</div>
</div>
<div class="sect2">
<h3 id="_logging_out">7.3. Logging Out</h3>
<div class="paragraph">
<p>To log out, simply perform a POST or GET request to <code>?-action=logout&amp;--no-prompt=1</code></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_actions">Actions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following sections pertain to actions in Xataface.  An action may either be a menu item, or an HTTP request handler.  Or it can be both.  They are defined in the actions.ini file (or actions.ini.php file) of your application, and their "handlers" are defined inside the "actions" directory of your application.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_material_icons">8. Using Material Icons</h2>
<div class="sectionbody">
<h3 id="_problem" class="discrete">Problem</h3>
<div class="paragraph">
<p>You want to use a <a href="https://material.io/resources/icons/?style=baseline">material icon</a> for a menu-item in your application, instead of an image.</p>
</div>
<h3 id="_solution" class="discrete">Solution</h3>
<div class="paragraph">
<p>The default theme of Xataface includes the material icons web font, so you can use any icons in that font on your actions via the <code>materialIcon</code> directive in your action.  For example, suppose we want to add a "Play" button to the rows of our table in list view.  We define our action as follows:</p>
</div>
<div class="listingblock">
<div class="title">A play action for the "songs" table.</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[play]
    condition="$query['-table'] == 'songs'" <b class="conum">(1)</b>
    category=list_row_actions <b class="conum">(2)</b>
    materialIcon=play_circle_outline <b class="conum">(3)</b>
    label="Play" <b class="conum">(4)</b>
    description="Play narration" <b class="conum">(5)</b>
    url="javascript:playSong()"</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The <code>condition</code> directive is used to limit our action so it only displays for the "songs" table.</p>
</li>
<li>
<p>The <code>category</code> directive makes the action appear in the "list_row_actions" menu (which is displayed as icons in each row of the list view.</p>
</li>
<li>
<p>The <code>materialIcon</code> directive specifies that we want to use the <a href="https://material.io/resources/icons/?search=play&amp;icon=play_circle_outline&amp;style=baseline">play_circle_outline</a> material icon.</p>
</li>
<li>
<p>The label, which is hidden for this menu type because the stylesheet is set to show only icons for the "list_row_actions" action.  It is still a good idea to define the label though in case this action is used in other contexts.</p>
</li>
<li>
<p>The description which is shown as tool-tip text if the user mouses over the action.</p>
</li>
</ol>
</div>
<h3 id="_finding_the_right_material_icon" class="discrete">Finding the Right Material Icon</h3>
<div class="paragraph">
<p>You can browse the available material icons <a href="https://material.io/resources/icons/?style=baseline">here</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-130620-080448.218.png" alt="Material Icons site">
</div>
<div class="title">Figure 23. Material Icons website</div>
</div>
<div class="paragraph">
<p>The label below the icon is the name of the icon, that you would use for your <code>materialIcon</code> directive.  If the lable is truncated, you can click the "Selected Icon" button in the lower left to get a more detailed view.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_form_customization">Form Customization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following chapters form a sort of cook book with recipes for customizing forms in Xataface.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_multiple_tabs_in_forms">9. Multiple Tabs in Forms</h2>
<div class="sectionbody">
<h3 id="_problem_2" class="discrete">Problem</h3>
<div class="paragraph">
<p>You want to split your edit/new record forms into multiple tabs</p>
</div>
<h3 id="_solution_2" class="discrete">Solution</h3>
<div class="paragraph">
<p>Use the `tab`directive in each field definition of the fields.ini file to specify the "tab" that each field should be placed in.</p>
</div>
<div class="paragraph">
<p>The tab directive of the fields.ini file specifies which tab of the record edit form a field should be displayed on. Xataface supports multiple tabs on the edit form by way of this tab directive. If no fields contain the tab directive then all fields are displayed in a single tab (named <code><em>main</em></code>).</p>
</div>
<div class="paragraph">
<p><strong>Example 1: Placing address info on separate tab</strong>
Consider the following people table:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">CREATE TABLE `people` (
    person_id int(11) not null auto_increment primary key,
    first_name varchar(32) not null,
    last_name varchar(32) not null,
    address varchar(100),
    city varchar(100),
    province varchar(100),
    country varchar(100),
    postal_code varchar(20)
)</code></pre>
</div>
</div>
<div class="paragraph">
<p>We want to split the fields into two tabs: "Personal Info" and "Address Info"</p>
</div>
<div class="paragraph">
<p>We&#8217;ll do this in two steps. We use the <code>tab</code> directive to assign all address-related fields to the <code>address_info</code> tab.</p>
</div>
<div class="listingblock">
<div class="title">fields.ini file.  Assigning fields to the "address_info" tab.</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[address]
    tab=address_info

[city]
    tab=address_info

[province]
    tab=address_info

[country]
    tab=address_info

[postal_code]
    tab=address_info</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, when we load the edit form of the people table, we see two tabs: "__main__" and "address_info"</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-090620-092422.464.png" alt="Image 090620 092422.464">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-090620-092436.892.png" alt="Image 090620 092436.892">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<code>__main__</code> is the name assigned to the default tab (for all fields that don&#8217;t have a tab defined explicitly.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Customizing the tab labels</strong></p>
</div>
<div class="paragraph">
<p>Next we will customize the tab labels by adding the following to the beginning of the fields.ini file:</p>
</div>
<div class="listingblock">
<div class="title">Defining the tabs in the fields.ini file.</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[tab:__main__]
    label="Personal Information"

[tab:address_info]
    label="Address Information"</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-090620-092537.254.png" alt="Image 090620 092537.254">
</div>
</div>
<div class="paragraph">
<p><a href="http://media.weblite.ca/files/photos/Picture%2012.png?max_width=640" class="bare">http://media.weblite.ca/files/photos/Picture%2012.png?max_width=640</a></p>
</div>
<div class="paragraph">
<p><strong>Reordering the tabs</strong></p>
</div>
<div class="paragraph">
<p>If we want to reorder the tabs so that the "address_info" tab comes first, we would just reorder the definitions of the tabs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[tab:address_info]
    label="Address Information"

[tab:__main__]
    label="Personal Information"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_delegating_new_record_form_to_a_different_table">10. Delegating "New Record Form" to a Different Table</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Xataface allows you to delegate "new record" input to a different table.  E.g. Given a Table <code>A</code>, you can configure Xataface to use the "new record" form for a different table <code>B</code> for inserting new records.</p>
</div>
<div class="paragraph">
<p><strong>Why might you want to do this?</strong></p>
</div>
<div class="paragraph">
<p>Xataface forms are built around the data model of the underlying table.  It generates input fields for each column of the underlying table.  In some cases, the "new record" form may want to take data in a different form that allows you to generate the underlying data.</p>
</div>
<div class="paragraph">
<p>For example, if you have a "Contacts" table, but you want the user to be able to insert contacts by simply entering their employee ID - and this will be used in the back-end to fetch some initial data about the user from another database.  In this case, your "new record" form should really just include a single field: "Employee ID".</p>
</div>
<div class="sect2">
<h3 id="_instructions_short_version">10.1. Instructions: Short Version</h3>
<div class="paragraph">
<p><strong>Definitions</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>SOURCE_TABLE</code> - The source table into which you wish to insert records.</p>
</li>
<li>
<p><code>TARGET_TABLE</code> - The target table whose "New Record" form you wish to use for the UI.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Steps:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add the <code>new_record_table=TARGET_TABLE</code> directive to the beginning of the fields.ini file of the SOURCE_TABLE.</p>
</li>
<li>
<p>Add a column named <code>xf_inserted_record_id</code> of type <code>TEXT</code> into the TARGET_TABLE.</p>
</li>
<li>
<p>In either the <code>beforeInsert()</code> or <code>afterInsert()</code> hooks of the TARGET_TABLE, process the inputs, and programmatically insert the appropriate record into the SOURCE_TABLE.</p>
</li>
<li>
<p>Also inside the <code>beforeInsert()</code> or <code>afterInsert()</code> hooks of TARGET_TABLE, set the value of the <code>xf_inserted_record_id</code> to the record ID of the SOURCE table that you programmatically inserted in step 3.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_instructions_by_example">10.2. Instructions By Example</h3>
<div class="paragraph">
<p>Let&#8217;s take the example I mentioned above.  We have a "contacts" table with lots of details about a contact, including <code>employee_id</code>.  When the user inserts a record, all they need to do is enter the "employee_id" and it will pull the rest of the data in from an external database.  So we will create a second "dummy" table that is only here to facilitate the creation of a new contact.  It includes only a single field "employee_id".</p>
</div>
<div class="paragraph">
<p>Our two tables might have the following definitions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">CREATE TABLE contacts (
  employee_id VARCHAR(32) PRIMARY KEY,
  first_name VARCHAR(64),
  last_name VARCHAR(64),
  ....
 )

 CREATE TABLE new_contact_form (
   employee_id VARCHAR(32) PRIMARY KEY,
   xf_inserted_record_id TEXT <b class="conum">(1)</b>
 )</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The <code>xf_inserted_record_id</code> field is a special field that will be used to pass the record ID of the corresponding contact record after insertion.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Step 1: Set <code>new_record_table</code></strong></p>
</div>
<div class="paragraph">
<p>At the beginning of the fields.ini file for the "contacts_table", add:</p>
</div>
<div class="listingblock">
<div class="title">tables/contacts/fields.ini file</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">new_record_table=new_contact_form</code></pre>
</div>
</div>
<div class="paragraph">
<p>This tells Xataface that the "new" action for the "contacts" table should redirect to the "new" action of the "new_contact_form" table.</p>
</div>
<div class="paragraph">
<p><strong>Step 2: Implement <code>beforeInsert()</code> Hook</strong></p>
</div>
<div class="paragraph">
<p>If we simply defined the <code>new_record_table</code> directive, it would result in the user being redirected to the <code>new_contact_form</code> table when they want to insert a new record into the <code>contacts</code> table, but it wouldn&#8217;t actually insert anything into the contacts table.  Nor would it return them back to the contacts table when done.  It would just leave the user in the "new_contacts_form" table - and would insert the record there only.</p>
</div>
<div class="paragraph">
<p>If we want to actually insert a record into the "contacts" table, we just do this programmatically.  Preferably inside the <code>beforeInsert()</code> or <code>afterInsert()</code> hooks of the <code>new_contact_form</code> table.</p>
</div>
<div class="paragraph">
<p>In the delegate class for the <code>new_contact_form</code>, we&#8217;ll do:</p>
</div>
<div class="listingblock">
<div class="title">tables/new_contact_form/new_contact_form.php file (Delegate class for the "new_contact_form" table).</div>
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">&lt;?php
class tables_new_contact_form {
    function beforeInsert(Dataface_Record $record) { <b class="conum">(1)</b>
        $employeeData = fetchEmployeeData($record-&gt;val('employee_id');
        // Assume that you've implemented fetchEmployeeData() elsewhere to get
        // the employee info from another database

        if (!$employeeData) {
            XFException::throwValidationFailure("Failed to find employee data for given employee ID.");
        }


        // Create a new contact record
        $contact = new Dataface_Record('contacts', array()); <b class="conum">(2)</b>
        $contact-&gt;setValues(array(
            'employee_id' =&gt; $employeeData['empid'],
            'first_name' =&gt; $employeeData['empFirstName'];
            ...
        ));
        $res = $contact-&gt;save(); <b class="conum">(3)</b>
        if (PEAR::isError($res)) {
            XFException::throwValidationFailure("Failed to insert contact: ".$res-&gt;getMessage());
        }

        // Store the record ID of the new contact record
        $record-&gt;setValue('xf_inserted_record_id', $contact-&gt;getId()); <b class="conum">(4)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>We implement the <code>beforeInsert()</code> callback, which is executed before the "new_contact_form" record is inserted.</p>
</li>
<li>
<p>We create a new <code>Dataface_Record</code> object for the "contacts" table, and insert data for the contact.</p>
</li>
<li>
<p>We call <code>save()</code> to store the "contacts" record.</p>
</li>
<li>
<p>Get the ID of the newly inserted contact, and add it to the <code>xf_inserted_record_id</code> field of the "new_contact_form" record.  This will be used by Xataface after to redirect back to the original contact table record when it is done.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-140420-010101.342.png" alt="Image 140420 010101.342">
</div>
<div class="title">Figure 24. Sequence diagram for inserting a new record in the Contacts table</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_ownerstamp_to_mark_record_ownership">11. Using <code>ownerstamp</code> to Mark Record Ownership</h2>
<div class="sectionbody">
<h3 id="_problem_3" class="discrete">Problem</h3>
<div class="paragraph">
<p>You want to "stamp" a record with the username or user ID of the user who created a record automatically.</p>
</div>
<h3 id="_solution_3" class="discrete">Solution</h3>
<div class="paragraph">
<p>Use the <code>ownerstamp</code> fields.ini directive on the field that you wish to store the userid in.</p>
</div>
<div class="paragraph">
<p>For example, consider a table "posts" that stores posts that users of the system make.  This table has a <code>posted_by</code> field to record the user that posted it.  You want this field to automatically populated with the user ID of the user that is currently logged in, so you can add the <code>ownerstamp</code> directive in the fields.ini file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[posted_by]
  ownerstamp=1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Adding this directive does a number of things simulataneously:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>It will set the user ID of the currently logged in user at the time that the record is inserted.</p>
</li>
<li>
<p>It will prevent the field from being updated later.</p>
</li>
<li>
<p>It will hide the "posted_by" field from all forms.</p>
</li>
</ol>
</div>
<h3 id="_discussion" class="discrete">Discussion</h3>
<div class="paragraph">
<p>Before the "ownerstamp" directive existed, you could accomplish the same thing by implementing a <code>beforeSave()</code> trigger and setting the field value to the currently logged in user, changing the field permissions so it can&#8217;t be changed after the fact, and setting the widget type to "hidden".  But since this is such a common requirement, it is much simpler to just set <code>ownerstamp=1</code> and be done with it.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_redirecting_user_to_different_page_after_saving_record">12. Redirecting User to Different Page After Saving Record</h2>
<div class="sectionbody">
<h3 id="_problem_4" class="discrete">Problem</h3>
<div class="paragraph">
<p>By default, when the user presses "Save" on the "Edit record form", they will be redirected back to the edit record form again after the save is complete.  You want to redirect them to a different page, such as the "View" page.</p>
</div>
<h3 id="_solution_4" class="discrete">Solution</h3>
<div class="paragraph">
<p>Override the "edit" action in your actions.ini file to specify the "after_action" directive.</p>
</div>
<div class="paragraph">
<p>E.g. Add the following to your application&#8217;s actions.ini (or actions.ini.php) file.</p>
</div>
<div class="listingblock">
<div class="title">the actions.ini file. Specifying that user should be directed back to the "view" action after editing the record.</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[edit &gt; edit]
    after_action=view</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you only want to apply this rule to a particular table, you can use the <code>after_action.{TABLENAME}</code> instead.  E.g.</p>
</div>
<div class="listingblock">
<div class="title">Specifying an after_action directive that only applies to editing records of the "users" table.</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[edit &gt; edit]
    after_action.users=view</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>The "new" action also supports the <code>after_action</code> and <code>after_action.tablename</code> directives.  E.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[new &gt; new]
    after_action=view</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_auto_updating_a_field_when_other_fields_are_changed">13. Auto-Updating a Field When Other Fields are Changed</h2>
<div class="sectionbody">
<h3 id="_problem_5" class="discrete">Problem</h3>
<div class="paragraph">
<p>You want the contents of a field to be automatically updated when the value of another field on the same form is changed.  For example, you have a "Program Title" field that should automatically be populated when the user selects the program ID.</p>
</div>
<h3 id="_solution_5" class="discrete">Solution</h3>
<div class="paragraph">
<p>You can use the <code>ajax_value</code> fields.ini property to make a field dynamically update whenever one or more other fields on the same form is changed.  When a change is detected, the field will load new data from a JSON web service specified by the URL in the property.</p>
</div>
<div class="paragraph">
<p><strong>Syntax:</strong></p>
</div>
<div class="paragraph">
<p><code>ajax_value=&lt;url-template&gt;#&lt;json-path-query&gt;</code></p>
</div>
<div class="paragraph">
<p><code>&lt;url-template&gt;</code> is a string that is used as a template for the URL to the web service from which to load the field&#8217;s content.  The template should contain one or more placeholders of the form <code>{fieldname}</code> which are replaced by the form value of the corresponding field.</p>
</div>
<div class="paragraph">
<p><code>&lt;json-path-query&gt;</code> is a <a href="http://jsonpath.com/">jsonPath</a> query describing which part of the JSON response should be used as the new field value.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
You can omit the json path query (everything from <code>#</code>), if the HTTP request will just return plain text or HTML.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Triggers</strong></p>
</div>
<div class="paragraph">
<p>The field will be updated whenever the URL would be changed.  The URL template may include variables with the syntax <code>{fieldname}</code> that will be replaced by the corresponding field when generating the web service URL.  If the values of any of the fields marked as variables changes, it will trigger an update.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="paragraph">
<p>Consider the following fields.ini file:</p>
</div>
<div class="paragraph">
<p>[source,ini</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[ProgramID]
widget:type=select
vocabulary=programs

[ProgramTitle]
ajax_value="?-action=export_json&amp;-table=Programs&amp;ProgramID={ProgramID}#0.ProgramTitle</pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, whenever the <code>ProgramID</code> field is changed (say to a value of "1"), it will trigger an AJAX request to <code>index.php?-action=export_json&amp;-table=Programs&amp;ProgamID=1</code>.</p>
</div>
<div class="paragraph">
<p>The JSON response will look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">[{"ProgramID":"1", "ProgramTitle":"Some program", ....}]</code></pre>
</div>
</div>
<div class="paragraph">
<p>When it receives the response, it will take the <code>ProgramTitle</code> attribute of the first result in the JSON response, and place it in the ProgramTitle field.  In the above example, it would be "Some program".</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>You can use the <code>widget:atts:data-xf-update-condition=empty</code> directive to <strong>only</strong> update the field value if it is currently empty.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_displaying_field_preview_using_ajax">14. Displaying Field Preview using AJAX</h2>
<div class="sectionbody">
<h3 id="_problem_6" class="discrete">Problem</h3>
<div class="paragraph">
<p>You want to display some richer feedback to the user based on the value entered into a field.  For example, on a field where the user enters a URL, you may want to display some information about the URL so that the user knows that they have entered the correct URL.</p>
</div>
<h3 id="_solution_6" class="discrete">Solution</h3>
<div class="paragraph">
<p>Use the <code>ajax_preview</code> directive, which works just like the <code>ajax_value</code> directive, except that it displays the result of the AJAX request just below the field as a "preview", rather than in the field itself.</p>
</div>
<div class="paragraph">
<p>Consider the scenario where you have the following table structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sql" data-lang="sql">CREATE TABLE posts (
    post_id INT(11) PRIMARY KEY AUTO_INCREMENT,
    page_url TEXT,
    article_title TEXT,
    article_description
)

CREATE TABLE user_posts (
    user_post_id INT(11) PRIMARY KEY AUTO_INCREMENT,
    post_id INT(11),
    comment TEXT
)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The "posts" table is central repository of posts.  The user_posts table is for a user to "post" a comment about a post. The idea is that a particular URL should only be imported into the "posts" table once, but many users can post comments around a "post" in the "users_posts" table.  We will only give the user direct access to the "user_posts" table, where they will provide the URL they want to post along with a comment about the post.</p>
</div>
<div class="paragraph">
<p>The challenge here is that the user_posts table doesn&#8217;t have a "page_url" field - just a post_id field.  We could use the depselect widget here, but this adds a step.  It would be better to hide the post_id field, and just provide a page_url field, which will automatically populate the "post_id" field with the correct post ID from the posts table.</p>
</div>
<div class="paragraph">
<p>So for our first step, we&#8217;ll hide the "post_id" field and add a page_url transient field:</p>
</div>
<div class="listingblock">
<div class="title">Adding a transient field for the post_url in the users_posts fields.ini file</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[post_id]
    widget:type=hidden

[post_url]
    transient=1
    order=-1
    widget:description="Please enter the URL to the article you wish to post"</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the user enters a URL into the post_url field we want to trigger an AJAX request to a custom action that will:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>See if a post has already been added at that URL, and return the ID of the post if found.</p>
</li>
<li>
<p>If the post hasn&#8217;t been added yet, we add it, and return the ID.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In either case the AJAX request should obtain a post ID which can be inserted into the post_id field.</p>
</div>
<div class="paragraph">
<p>Such a custom action might look like the following:</p>
</div>
<div class="listingblock">
<div class="title">Sample Action (defined in actions/get_post_id.php) to get a Post ID for a given page url.</div>
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">&lt;?php
class actions_get_post_id {
    function handle($params) {
        header('Content-Type:text/plain');
        if (!@$_GET['page_url']) {
            return;
        }
        //echo $_GET['page_url'];exit;
        $user = getUser();
        $post = df_get_record('posts', array('page_url' =&gt; '='.$_GET['page_url']));

        if (!$post) {
            $post = new Dataface_Record('posts', array());
            $post-&gt;setValues(array(
                'posted_by' =&gt; $user-&gt;val('user_id'),
                'page_url' =&gt; $_GET['page_url']
            ));
            $res = $post-&gt;save();
        }
        echo $post-&gt;val('post_id');
    }
}
?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>We will use the <code>ajax_value</code> directive on the <code>post_id</code> field to automatically populate it from that AJAX action when the value of <code>page_url</code> changes.</p>
</div>
<div class="listingblock">
<div class="title">Add the ajax_value directive to populate the post_id field when post_url is updated.</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[post_id]
    widget:type=hidden
    ajax_value="?-action=get_post_id&amp;page_url={post_url}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Lastly, we want to display a preview of the page content below the page_url field.  We will use the <code>ajax_preview</code> directive for this.  First we&#8217;ll create an AJAX action to display this preview, given the post ID.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">&lt;?php
class actions_ajax_post_preview {

    function handle($params) {
        if (!@$_GET['post_id']) {
            return;
        }
        $post = df_get_record('posts', array('post_id' =&gt; '='.$_GET['post_id']));
        if ($post) {
            df_display(array('post' =&gt; $post), 'ajax_post_preview.html'); <b class="conum">(1)</b>
        }
    }
}
?&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>"ajax_post_preview.html" template should be in the application&#8217;s templates directory.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now we can use this from our `ajax_preview directive:</p>
</div>
<div class="listingblock">
<div class="title">Adding the ajax_preview directive to update the preview automatically with post_id is changed.</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[post_url]
    transient=1
    order=-1
    widget:description="Please enter the URL to the article you wish to post"
    ajax_preview="?-action=ajax_post_preview&amp;post_id={post_id}"</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-070620-011602.097.png" alt="Image 070620 011602.097">
</div>
<div class="title">Figure 25. Ajax preview displayed below the post_url field.</div>
</div>
<div class="paragraph">
<p><strong>Bonus Points</strong></p>
</div>
<div class="paragraph">
<p>We&#8217;re not quite done.  Our current setup works great for the new record form, because the user will be adding the URL.  But if they&#8217;re editing an existing record, the post_id value will already by set, but the user hasn&#8217;t entered anything the post_url field (because it is transient).  We need to add an <code>ajax_value</code> directive to the post_url field so that it auto-populates based on the value of the post_id field.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll use the export_json action as our AJAX action so we don&#8217;t need to create a custom action.</p>
</div>
<div class="listingblock">
<div class="title">Adding the ajax_value directive to the post_url field so that it auto-populates on the edit form.</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[post_url]
    transient=1
    order=-1
    widget:description="Please enter the URL to the article you wish to post"
    ajax_preview="?-action=ajax_post_preview&amp;post_id={post_id}"
    ajax_value="?-table=posts&amp;-action=export_json&amp;post_id=={post_id}&amp;-mode=browse&amp;-limit=1&amp;--fields=page_url#0.page_url"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_disabling_client_side_validation">15. Disabling Client-side Validation</h2>
<div class="sectionbody">
<h3 id="_problem_7" class="discrete">Problem</h3>
<div class="paragraph">
<p>You want to disable client-side validation for a particular field, but keep the server-side validaton.</p>
</div>
<h3 id="_solution_7" class="discrete">Solution</h3>
<div class="paragraph">
<p>Use the <code>widget:validation=server</code> fields.ini directive.</p>
</div>
<div class="paragraph">
<p>E.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">[myfield]
  widget:validation=server</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setting_fixed_number_of_rows_in_the_grid_widget">16. Setting Fixed Number of Rows in the Grid Widget</h2>
<div class="sectionbody">
<h3 id="_problem_8" class="discrete">Problem</h3>
<div class="paragraph">
<p>You have a grid widget for editing related records on a form.  Rather than have it start with only a single row, and have additional rows appear only as the user enters data into the last row, you want it to display a fixed number of rows and have some of the data pre-populated.</p>
</div>
<h3 id="_solution_8" class="discrete">Solution</h3>
<div class="paragraph">
<p>Use the <code>widget:fixedrows</code> directive to a specific number of rows, and you can implement the <code>fieldname__prepareGridData($record, $cols, $data)</code> delegate method to return the data to prepopulate the grid with.</p>
</div>
<div class="listingblock">
<div class="title">fields.ini file</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[exam_results]
  relationship=exam_results
  widget:type=grid
  widget:fixedrows=3
  widget:cols="exam_name,exam_grade"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Delegate class</div>
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">class tables_students {
    function exam_results__prepareGridData($record, $cols, &amp;$data) {
        if (count($data) == 0) {
            $data[] = array('exam_name' =&gt; 'Midterm 1', 'exam_grade' =&gt; '');
            $data[] = array('exam_name' =&gt; 'Midterm 2', 'exam_grade' =&gt; '');
            $data[] = array('exam_name' =&gt; 'Final', 'exam_grade' =&gt; '');
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_list_customization">List Customization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following chapters form a sort of cook book with recipes for customizing result lists in Xataface.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_adding_option_to_filter_result_list">17. Adding Option to Filter Result LIst</h2>
<div class="sectionbody">
<h3 id="_problem_9" class="discrete">Problem</h3>
<div class="paragraph">
<p>You want to add a drop-down list for the user to select filters for the result set.</p>
</div>
<div class="sect2">
<h3 id="_solution_9">17.1. Solution</h3>
<div class="paragraph">
<p>Use the <code>filter</code> directive in the fields.ini file on any field that you want the filter to be added for.</p>
</div>
<div class="listingblock">
<div class="title">Field definition in fields.ini file using the filter directive.</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[test_field]
  filter=1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, if you navigate to this table&#8217;s list view, you&#8217;ll see a drop-down list at the top of the results where you can select all of the distinct values in the <code>test_field</code> column.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-150520-070017.404.png" alt="Image 150520 070017.404">
</div>
<div class="title">Figure 26. List View when a filter field defined.</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-150520-070032.226.png" alt="Image 150520 070032.226">
</div>
<div class="title">Figure 27. Expanding the filter list, you can see all of the distinct values for the test_field column.</div>
</div>
<div class="paragraph">
<p>If you select one of the options, it will filter the results to only show those results that match the filter.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hiding_filter_counts">18. Hiding Filter Counts</h2>
<div class="sectionbody">
<h3 id="_problem_10" class="discrete">Problem</h3>
<div class="paragraph">
<p>You want to hide the counts for each entry in the "filters" drop-down list on the list view.  By default when you add a filter list via the <code>filter</code> directive, each row has the "count" displayed beside it:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-150520-065039.669.png" alt="Image 150520 065039.669">
</div>
<div class="title">Figure 28. A result filter list.  Notice each row has a (1) beside it indicating that there is 1 row matching that filter.</div>
</div>
<div class="paragraph">
<p>We want to hide this.</p>
</div>
<h3 id="_solution_10" class="discrete">Solution</h3>
<div class="paragraph">
<p>Use the <code>show_filter_counts</code> preferences directive to hide these counts as follows.  In the <code>_prefs</code> section of the <code>conf.ini</code> file, add:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">show_filter_counts=0</code></pre>
</div>
</div>
<div class="paragraph">
<p>After this change, the filter lists will look like:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Image-150520-065357.583.png" alt="Image 150520 065357.583">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sorting_filter_results">19. Sorting Filter Results</h2>
<div class="sectionbody">
<h3 id="_problem_11" class="discrete">Problem</h3>
<div class="paragraph">
<p>Filter lists are sorted by the "filtered" field in alphabetical order.  You want to sort the filter lists on some other column.</p>
</div>
<h3 id="_solution_11" class="discrete">Solution</h3>
<div class="paragraph">
<p>Use the <code>filter.sort.</code> fields.ini directive to specify the field that the filter should sort on.</p>
</div>
<div class="paragraph">
<p>E.g.</p>
</div>
<div class="listingblock">
<div class="title">Sort the "city" filter in descending order</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[city]
  filter=1
  filter.sort="city desc"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_searching">Searching</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following section include tips on configuring search support in Xataface application.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_case_sensitive_searches">20. Case-Sensitive Searches</h2>
<div class="sectionbody">
<h3 id="_problem_12" class="discrete">Problem</h3>
<div class="paragraph">
<p>You searches on a particular column to be case-sensitive.  (E.g. If the user searches for "Bob", it should match "Bob" but not "bob").</p>
</div>
<h3 id="_solution_12" class="discrete">Solution</h3>
<div class="paragraph">
<p>Use the <code>collate</code> fields.ini directive to "utf8_general_cs" (or any other supported collation that is case-sensitive.</p>
</div>
<div class="paragraph">
<p>E.g.</p>
</div>
<div class="paragraph">
<div class="title">fields.ini file, specifying that searches of the "name" field should be case sensitive.</div>
<p>[source,ini</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[name]
   collate=utf8_general_cs</pre>
</div>
</div>
<h3 id="_discussion_2" class="discrete">Discussion</h3>
<div class="paragraph">
<p>By default, the case-sensitivity of searches depends on the collation of the underlying table and column in MySQL.  If the column was defined with a case-sensitive collation (e.g. <code>utf8_general_cs</code>), then all searches on this column will be case-sensitive.  If, however, it was defined with a case-insensitive collaction (e.g. <code>utf8_general_ci</code>), all searches will be case-insensitive.  If you want to change the behaviour of the app, you could simply change the underlying collation.  But in some cases you may not want to modify the table structure (or you won&#8217;t have access to the table structure).  In such cases, the "collate" directive is helpful.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_explicitly_specifying_case_sensitivity_of_a_search">21. Explicitly Specifying Case-sensitivity of a Search</h2>
<div class="sectionbody">
<h3 id="_problem_13" class="discrete">Problem</h3>
<div class="paragraph">
<p>You want to perform a case-sensitive search on a field that has a case-insensitive collation.</p>
</div>
<h3 id="_solution_13" class="discrete">Solution</h3>
<div class="paragraph">
<p>Wrap the query value in a command wrapper, and use the "cs" command to specify "case-sensitive" (or "ci" to specify case-insensitive").</p>
</div>
<div class="paragraph">
<p>E.g.</p>
</div>
<div class="paragraph">
<p>If you want to search for "Bob" in the name field, enter the following in the search field for "Bob".</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#Bob#cs</pre>
</div>
</div>
<div class="paragraph">
<p>If you, instead wanted to explicitly perform a case-insensitive search you would enter</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#Bob#ci</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_file_uploads">File Uploads</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following sections pertain to management of file uploads.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specifying_content_disposition_of_file_download">22. Specifying Content Disposition of File Download</h2>
<div class="sectionbody">
<h3 id="_problem_14" class="discrete">Problem</h3>
<div class="paragraph">
<p>By default the contents of <code>blob</code> fields and container fields are downloaded as a file download in the browser.  You want the browser to navigate to the file instead of downloading it.</p>
</div>
<h3 id="_solution_14" class="discrete">Solution</h3>
<div class="paragraph">
<p>Use the <code>contentDisposition=inline</code> fields.ini directive.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[myfield]
    contentDisposition=inline</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, when users click on the link for this field, the browser will navigate to the field content.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
The <code>contentDisposition</code> directive will be used to set the <code>Content-Disposition</code> HTTP header.  Learn more about this header <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition">here</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_http_request_handling">HTTP Request Handling</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following sections include tips for configuring how Xataface applications respond to HTTP requests.  This includes topics such as event routing, response types, etc&#8230;&#8203;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specifying_a_default_action">23. Specifying a Default Action</h2>
<div class="sectionbody">
<h3 id="_problem_15" class="discrete">Problem</h3>
<div class="paragraph">
<p>You want your application to use a default action other than the Xataface default, if the user doesn&#8217;t explicitly provide an "-action" parameter.</p>
</div>
<h3 id="_solution_15" class="discrete">Solution</h3>
<div class="paragraph">
<p>Use the <code>default_action</code> conf.ini directive.</p>
</div>
<div class="paragraph">
<p>E.g.:</p>
</div>
<div class="listingblock">
<div class="title">Setting a default action at the beginning of your conf.ini file.</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">default_action=find</code></pre>
</div>
</div>
<div class="paragraph">
<p>This would result in the user being directed to the "find" action by default.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If "default_action" is not specified, then Xataface will use the "list" action as the default.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_different_default_action_depending_on_table">24. Using Different Default Action Depending on Table</h2>
<div class="sectionbody">
<h3 id="_problem_16" class="discrete">Problem</h3>
<div class="paragraph">
<p>You want to specify a default action only for one table in your application.  The "default_action" conf.ini directive sets the default action application-wide.</p>
</div>
<h3 id="_solution_16" class="discrete">Solution</h3>
<div class="paragraph">
<p>Use the <code>default_action.tablename</code> directive in your conf.ini file.  (<code>tablename</code> should be replaced with your desired table name.  For example, suppose I want to make the "view" action the default action for the "posts" table, then I would define the following at the beginning of the conf.ini file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">default_action.posts=view</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specifying_default_query_parameters_for_default_actions">25. Specifying Default Query Parameters for Default Actions</h2>
<div class="sectionbody">
<h3 id="_problem_17" class="discrete">Problem</h3>
<div class="paragraph">
<p>You want to supply additional query parameters for your default actions.  These parameters should only be applied when the default action is used.</p>
</div>
<h3 id="_solution_17" class="discrete">Solution</h3>
<div class="paragraph">
<p>Use the <code>default_params.tablename</code> directive.  E.g.</p>
</div>
<div class="listingblock">
<div class="title">Setting some default query parameters for when the default action is used on the posts table.</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">default_action.posts=view
default_params.posts="post_id=2&amp;foo=bar"</code></pre>
</div>
</div>
<div class="paragraph">
<p>These default parameters will be used if the user requests a URL like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>index.php?-table=posts</pre>
</div>
</div>
<div class="paragraph">
<p>The above would effectively be the same as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>index.php?-table=posts&amp;-action=view&amp;post_id&amp;foo=bar</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>default_params.tablename</code> directive only applies when the default action is being used.  E.g. In the above example, if the user requests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>index.php?-table=posts&amp;-action=view</pre>
</div>
</div>
<div class="paragraph">
<p>The default params would not be applied because the "-action" has been specified explicitly by the user.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The above example shows the <code>default_params.posts</code> directive specified as a URL-encoded string.  However, you can also define the parameters as a section.</p>
</div>
<div class="paragraph">
<p>E.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[default_params.posts]
  post_id=2
  foo=bar</code></pre>
</div>
</div>
<div class="paragraph">
<p>This would be equivalent to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">default_params.posts="post_id=2&amp;foo=bar"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_showing_the_edit_tab_by_default_for_record_details">26. Showing the "Edit" Tab By Default for Record Details</h2>
<div class="sectionbody">
<h3 id="_problem_18" class="discrete">Problem</h3>
<div class="paragraph">
<p>By default, when the user clicks on a record to see its details, they will be shown the "View" tab.  You want to show them the "Edit" tab instead.</p>
</div>
<h3 id="_solution_18" class="discrete">Solution</h3>
<div class="paragraph">
<p>Use the <code>default_browse_action</code> directive of the conf.ini file. This directive is analagous to the <code>default_action</code> directive, except it is only applied when the user requests the "browse" action, which is the default action used for displaying record details.</p>
</div>
<div class="paragraph">
<p>The direct solution to our problem would be the following at the beginning of the conf.ini file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">default_browse_action=edit</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Just like the <code>default_action</code> directive, you can specify a different default browse action for different tables using the <code>default_browse_action.tablename</code> directive.  E.g.</p>
</div>
<div class="listingblock">
<div class="title">Only setting the default browse action to edit on the "posts" table.</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">default_browse_action.posts=edit</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setting_default_query_parameters_for_the_browse_action">27. Setting Default Query Parameters for the <code>browse</code> Action</h2>
<div class="sectionbody">
<h3 id="_problem_19" class="discrete">Problem</h3>
<div class="paragraph">
<p>You have specified a custom action that you are using as the default "browse" action for your table via the <code>default_browse_action.mytable=myaction</code> directive.  However your action requires some additional query parameters to work correctly.  You need to add these default parameters somehow.</p>
</div>
<h3 id="_solution_19" class="discrete">Solution</h3>
<div class="paragraph">
<p>Use the <code>default_browse_params.tablename</code> directive to add parameters to the <code>browse</code> action. This directive works similarly to the <code>default_params.tablename</code> directive.  E.g. Let&#8217;s add a "foo" query parameter by default when the user accesses the "browse" action on the "posts" table.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">default_browse_action.posts=myaction
default_browse_params.posts="foo=bar"</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>The above example shows the <code>default_browse_params.posts</code> directive specified as a URL-encoded string.  However, you can also define the parameters as a section.</p>
</div>
<div class="paragraph">
<p>E.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[default_browse_params.posts]
  foo=bar
  fuzz=bazz</code></pre>
</div>
</div>
<div class="paragraph">
<p>This would be equivalent to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">default_browse_params.posts="foo=bar&amp;fuzz=bazz"</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setting_a_related_records_tab_as_the_default_browse_action">28. Setting a Related Records Tab as the Default Browse Action</h2>
<div class="sectionbody">
<h3 id="_problem_20" class="discrete">Problem</h3>
<div class="paragraph">
<p>When the user clicks on a record in the "list" view, you want them to see a related record tab instead of the "View" tab by default.</p>
</div>
<h3 id="_solution_20" class="discrete">Solution</h3>
<div class="paragraph">
<p>We can achieve this by way of the <code>default_browse_params.tablename</code> conf.ini directives.  For example, suppose we wanted to show the "authors" relationship of the "posts" table by default when a post&#8217;s details are shown:</p>
</div>
<div class="listingblock">
<div class="title">Specifying that the "authors" relationship should be shown by default when viewing a record in the posts table.</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">default_browse_params.posts="-relationship=authors"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice here, that we didn&#8217;t actually need to use the <code>default_browse_action</code> parameter to specify that it should use the <code>related_records_list</code> action (which is the action used to display a related list).  Xataface infers this by the presence of the "-relationship" directive.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tables_views_and_queries">Tables, Views, and Queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following chapters pertain tables, views, and queries.  It includes tips on how to set up your tables, views, and queries for optimal performance and flexibility.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_accessing_an_sql_query_like_a_table">29. Accessing an SQL query like a Table</h2>
<div class="sectionbody">
<h3 id="_problem_21" class="discrete">Problem</h3>
<div class="paragraph">
<p>You want to create a user-specific SQL query and navigate its results as if it were a proper table.  You want the results of this table to be different for different users.</p>
</div>
<h3 id="_solution_21" class="discrete">Solution</h3>
<div class="paragraph">
<p>There are a few strategies that you could use for this.  You could simply use a MySQL view, and set up a security filter on the table.  In some cases, this may not be flexible enough, though.  In such cases you can use a dynamic query.</p>
</div>
<div class="paragraph">
<p>You can create a dynamic query as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add a directory to your application&#8217;s "tables" directory named <code>_tmp_{NAME}</code> where <code>{NAME}</code> is the name of your query.</p>
</li>
<li>
<p>Create a <code>fields.ini.php</code> (or fields.ini) file inside this directory with at least a <code>__sql__</code> directive.  This <code>__sql__</code> directive is were you specify the SQL query that should be used for the contents of the table.</p>
</li>
<li>
<p>Specify the primary key for the table by adding a <code>Key=PRI</code> directive to one of the fields in the fields.ini file.  You can inject the user id of the currently logged in user with the <code>{{USER_ID}}</code> string.  This will be replaced by the user ID.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For example, let&#8217;s add a dynamic query called "my_posts", which is basically just a list of posts that the current user has posted.  This provides an easy way for the user to generate a feed of his own posts.</p>
</div>
<div class="paragraph">
<p>First we&#8217;ll create the <code>_tmp_my_posts</code> directory, inside the "tables" directory.  Then we&#8217;ll add our <code>fileds.ini.php</code> file:</p>
</div>
<div class="listingblock">
<div class="title">fields.ini.php file</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">;&lt;?php exit; // To prevent this file from being served
__sql__ = "select * from posts where posted_by='{{USER_ID}}'"

[post_id]
   Key=PRI</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>You can alternatively create a delegate class for your table by creating a delegate class (<code><em>tmp_my_posts.php</code>) and define an <code>__sql_</em>()</code> method.</p>
</div>
<div class="paragraph">
<p>E.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">&lt;?php
class tables__tmp_my_posts {
    function __sql__() {
        return "select * from posts where posted_by='{{USER_ID}}'";
    }
}</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can access this "table" just as you would, a normal table.  Just remember that the full table name is "_tmp_my_posts".  E.g. If you go to "index.php?-table=_tmp_my_posts", it will show you these results.</p>
</div>
<h3 id="_how_dynamic_queries_work" class="discrete">How Dynamic Queries Work</h3>
<div class="paragraph">
<p>When xataface receives a request for a table whose name starts with "<em>tmp</em>" it begins by performing the <code>__sql__</code> and loading the results into a temporary table.  This operation is very fast because temporary tables are typically stored in RAM, and they are only usable in the current session (i.e. other users cannot see this table).</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Dynamic query tables are ephemeral, so any changes you make to is will disappear at the end of the request.  This means that you cannot insert or update records into these tables.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_appendix_1_configuration_directives">Appendix 1: Configuration Directives</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following chapters serve as reference to show all of the various configuration directives available in Xataface apps.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_preferences_directives">30. Preferences Directives</h2>
<div class="sectionbody">
<h3 id="_how_to_set_preferences" class="discrete">How to Set Preferences</h3>
<div class="paragraph">
<p>Xataface preferences can be defined in 3 ways:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <code>[_prefs]</code> section of the conf.ini file for global static preferences.</p>
</li>
<li>
<p>Implementing the <code>getPreferences()</code> method in the Application Delegate Class</p>
</li>
<li>
<p>In the <code><em>prefs</em></code> section of the fields.ini file for a table for static preferences on that table. (Limited to only certain preferences).</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Example [_prefs] section in the conf.ini</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[_prefs]
    hide_updated=1
    hide_posted_by=1</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example getPreferences? method in the Application Delegate Class:</div>
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">function getPreferences(){
    return array('hide_update'=&gt;1, 'hide_posted_by'=&gt;1);

}</code></pre>
</div>
</div>
<h3 id="_available_preferences" class="discrete">Available Preferences</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Available Preferences</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Preference</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_result_stats</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Show the result statistics (e.g. found x of y records in table z)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_jump_menu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Show he drop-down menu that allows you to "jump" to any record in the found set.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_result_controller</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Show Next, previous, page number .. links&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_table_tabs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Show Details, List, Find, etc&#8230;&#8203; tabs.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_actions_menu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Show New record, Show all, delete, etc..</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_logo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Show logo at top of app</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_tables_menu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Show the tabs to select a table.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_search</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Show search field in upper right.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_record_actions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Show actions related to particular record</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_bread_crumbs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Show bread crumbs at top of page to show where you are.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_record_tabs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">View, Edit, Translate, History, etc&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_record_tree</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Show tree to navigate the relationships of this record.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">list_view_scroll_horizontal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to scroll list horizontal if it exceeds page width</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">list_view_scroll_vertical</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to scroll list vertical if it exceeds page height.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hide_posted_by</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to hide the posted by text in glance lists (e.g. in the view tab, the related records are shown in the left column. This hides the posted by text next to each related record.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0b4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hide_updated</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to hide the updated text in the glance lists (e.g. in the view tab, the related records are shown in the left column. This hides the updated text next to each related record.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0b4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SummaryList_logo_width</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The width of the logo to be used as the preview image in summary lists.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SummaryList_hideSort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hides the sort control for a summary list (the box that allows users to sort by column).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hide_user_status</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hides the user&#8217;s status (e.g. "You are logged in as &#8230;&#8203;"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hide_personal_tools</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hides the personal tool links in upper right. This includes likes such as "Control Panel" and "My Profile"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hide_resultlist_controller</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hides the controller for a result list (E.g. next/back/results per page etc&#8230;&#8203;).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hide_related_sections</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hides the sections of the view tab that show the related records. These are the sortable section boxes. Not the related tabs.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hide_record_search</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hides the record search form that appears in the view tab. Not to be confused with the find tab.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_resultlist_controller_only_when_needed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the resultlist controller (e.g. back/next/results per page/etc&#8230;&#8203;) to only show up if paging is required (i.e. if there are more records than can be shown on one page (according to the '-limit' parameter).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hide_record_view_logo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hides the logo for a record that appears in the upper left of the view tab for each record.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">horizontal_tables_menu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to force the tables menu to appear as tabs along the top of the page (alternative is as a menu on the left). If there are 10 or fewer allowed tables, then the default is 1, otherwise the default is set to 0.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hide_result_filters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In list view, setting this value to 1 will cause the column filters to be hidden (the select lists to filter the results).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_filter_counts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A value of 0 will hide the result filter counts.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">disable_select_rows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A value of 1 causes the checkboxes in each row of the list view to be hidden.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">result_list_use_geturl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the getURL() method to link to records in the list view rather than the default (which uses the -cursor parameter).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">disable_ajax_record_details</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to disable the ajax record details (the '+' sign beside each record in list view that expands to show the record details.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7</p></td>
</tr>
</tbody>
</table>
<h3 id="_inverse_preferences" class="discrete">Inverse Preferences</h3>
<div class="paragraph">
<p>The following preferences perform the inverse of some of the options above. When these options are set to 1, their respective option is set to 0.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Inverse Preferences</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Inverse</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hide_nav_menu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_tables_menu</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hide_view_tabs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_table_tabs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hide_result_controller</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_result_controller</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hide_table_result_stats</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_result_stats</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hide_search</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">show_search</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-06-13 08:09:17 -0700
</div>
</div>
</body>
</html>